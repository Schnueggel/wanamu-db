box: golio/ubuntu:latest
build:
  steps:
    - script:
        name: Pseudo
        code: |
          export
deploy:
  steps:
    - add-ssh-key:
        keyname: OVH_KEY
    - script:
        name: install ssh
        code: |
          ssh-agent -s
    - script:
        name: Deploy
        code: |
          ssh -l $DEPLOY_USER -o UserKnownHostsFile=/dev/null -tt -o StrictHostKeyChecking=no $DEPLOY_HOST /bin/bash -e <<EOF
          cd ./$WERCKER_GIT_REPOSITORY
          sudo git pull
          sudo docker-compose up -d
          exit 0
          EOF
  after-steps:
    - slack-notifier:
        url: $SLACK_WEBHOOK_URL
        channel: wercker-notify
        username: werckerbot